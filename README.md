# 程序目标：导入探针相关数据
## 解决痛点： 
1. Excel表格中合并单元格需要手动划分，太过繁琐；
2. 实现自动去重（对于已经添加的探针数据，不再进行导入）；
3. 将手动执行多个脚本的操作全部使用程序一次性操作完毕；
4. 生成定位引擎所需的目标Excel；

## Excel读取实现思路： 
1. 读取Excel表格的一个sheet，从中获取每个单元格的起始行、终点行、起始列、终点列；
2. 对于所有的合并单元格进行特殊处理，将它们重新划分为单个单元格，并记录这些单元格的起始行、终点行、起始列、终点列；
3. 按照起始行、终点行、起始列、终点列排列所有单元格的值，并且将它们与列名对应上；
4. 将它们映射存储到一个临时表中；
5. 对于其他的sheet也进行同样的1~4的操作；
6. 关联多个表的数据，插入到目标表中；

## 关系明确：
1. 公区探针，无需铺位号
2. 店铺探针，与铺位号进行关联，且前者对后者是一对一的关系
3. 店铺与铺位号进行关联

## 整体导入流程：
1. 在AC管理平台上设置好探针的网络位置，配置策略，然后为探针添加策略，并为这些探针应用策略；
2. 通过本程序配合现场施工给出的探针信息Excel表格导入相关探针数据；
3. 将第1~2步操作都完成的探针信息，生成一份定位引擎配置管家所需要的Excel出来（其中都是*新成功添加的探针信息*），然后导入到定位引擎的地图中；
4. 拖拽探针，获取正确坐标，再导出包含正确坐标的探针信息的Excel表格
5. 将此表格导入到程序中，按照一定的比例，修改坐标信息并更新到数据库中
6. 重启定位引擎和实时计算服务
7. 重启转发程序，因为转发程序中对于探针的数据只在运行时读取一次（好像是这样）

## 需要的Excel表格及表格中应有的字段
公区探针Excel表：楼栋、楼层、公区编号、（公区）包含的探针编号、（公区）包含的探针MAC地址、（公区）关联的铺位编号、
店铺探针Excel表：楼栋、楼层、店铺名称、业态名称、业态级别、（店铺）包含的铺位编号、（铺位）包含的探针编号、（铺位）包含的探针MAC地址、

## 表中按序需要存在的记录/按照以下顺序检查和生成对应的表记录
√  表示公区探针Excel表需要操作的表
※ 表示店铺探针Excel表需要操作的表
楼栋记录（BUSI_BUILDING）√※
楼层记录（BUSI_FLOOR）√※
业态记录（BUSI_RETAIL）※
店铺记录（BUSI_SHOP）※
公区记录（BUSI_PUBLIC_SPACE）√
铺位号记录（BUSI_SHOP_BERTH_INFO）√※
楼层和店铺关系记录（BUSI_FLOOR_SHOP）※
楼层和公区关系记录（BUSI_FLOOR_PUB_SPACE）√
铺位号和公区关系记录（BUSI_SHOP_BERTH_SPACE）√
铺位号和店铺关系记录（BUSI_SHOP_BERTH）※
店铺和公区关系记录（BUSI_SHOP_PUB_SPACE）√※
探针记录（BUSI_AP）√※

BUSI_BUILDING,BUSI_FLOOR,BUSI_RETAIL,BUSI_SHOP,BUSI_PUBLIC_SPACE,BUSI_SHOP_BERTH_INFO,BUSI_FLOOR_SHOP,BUSI_FLOOR_PUB_SPACE,BUSI_SHOP_BERTH_SPACE,BUSI_SHOP_BERTH,BUSI_SHOP_PUB_SPACE,BUSI_AP